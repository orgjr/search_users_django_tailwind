{% load static %}
<!DOCTYPE html>
<html>
  <head>
    <title>Search Users</title>
    <link rel="stylesheet" href="{% static 'css/output.css' %}" />
  </head>

  <body
    class="bg-gray-100 min-h-screen flex flex-row gap-[70px] p-[70px] overflow-hidden"
  >
    <!-- left column -->
    <div class="flex flex-col w-[50vw] h-[calc(100vh-140px)]">
      <div class="w-[450px] h-[calc(35vh-70px)] mx-auto">
        <h2 class="text-2xl font-bold mb-8 text-gray-800 text-center">
          Qual usuário você quer encontrar?
        </h2>

        <div class="w-full max-w-md bg-white shadow-md rounded-xl p-6">
          <form action="" method="GET" class="flex flex-col space-y-4">
            <input
              type="text"
              name="search"
              value="{{ query }}"
              placeholder="Procure por nome, e-mail ou departamento"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none"
            />
            <input
              type="submit"
              value="Enviar"
              class="w-full bg-blue-600 text-white font-semibold py-2 rounded-lg hover:bg-blue-700 cursor-pointer transition-colors"
            />
          </form>
        </div>
      </div>

      {% if query %} {% if filtered_users %}
      <div
        class="mt-10 w-full bg-white shadow-md rounded-xl p-6 max-h-[calc(65vh-70px)] flex flex-col"
      >
        <h3 class="text-xl font-semibold mb-4 text-gray-700 flex-shrink-0">
          Resultado da busca:
        </h3>

        <div id="content" class="overflow-y-auto flex-1 space-y-6">
          {% for u in filtered_users %}
          <ul class="grid grid-cols-3 gap-4 border-b border-gray-200 pb-4">
            <li class="flex flex-col">
              <span class="font-semibold text-gray-600">Nome completo:</span>
              <p class="text-gray-800">{{ u.get_full_name }}</p>
            </li>
            <li class="flex flex-col">
              <span class="font-semibold text-gray-600">E-mail:</span>
              <p class="text-gray-800">{{ u.email }}</p>
            </li>
            <li class="flex flex-col">
              <span class="font-semibold text-gray-600">Departamento:</span>
              <p class="text-gray-800">{{ u.departamento|default:'N/A'}}</p>
            </li>
          </ul>
          {% endfor %}
        </div>
      </div>
      {% else %}
      <p class="mt-8 text-red-600 font-semibold">Nenhum usuário encontrado.</p>
      {% endif %} {% endif %}
    </div>

    <!-- right column -->
    <div
      class="w-[40vw] bg-white shadow-md rounded-xl p-6 h-[calc(100vh-140px)] flex flex-col"
    >
      <h3 class="text-xl font-semibold mb-6 text-gray-700 flex-shrink-0">
        Todos os usuários
      </h3>
      <div class="grid grid-cols-1 gap-6 overflow-y-auto flex-1 pr-2">
        {% for all in all_users %} {% if not all.is_superuser %}
        <div
          class="bg-gray-50 shadow-sm rounded-lg p-4 hover:shadow-md transition-shadow"
        >
          <p class="font-semibold text-gray-800">{{ all.get_full_name }}</p>
          <p class="text-gray-600 text-sm">{{ all.email }}</p>
          <p class="text-gray-600 text-sm">
            {{ all.departamento|default:'N/A' }}
          </p>
          <p class="text-gray-400 text-xs">
            Joined: {{ all.date_joined|date:"d/m/Y" }}
          </p>
        </div>
        {% endif %} {% endfor %}
      </div>
    </div>
  </body>
</html>
